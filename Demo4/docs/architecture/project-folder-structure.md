# Project Folder Structure

## Overview

AgentManager now automatically organizes all workflow results into dated project folders, making it easy to track and manage multi-agent task outputs over time.

## Directory Layout

```
AgentManager/
├── docs/                          # All documentation files
│   ├── project-folder-structure.md
│   ├── project-roadmap.md
│   └── ...
│
├── projects/                      # Base directory for all project outputs
│   ├── 2025-10-14/               # Today's date (YYYY-MM-DD)
│   │   ├── project_name_1/       # Project folder (spaces replaced with underscores)
│   │   │   ├── project_name_1_request.json  # Original workflow request
│   │   │   ├── FINAL_OUTPUT.md   # Final synthesized result
│   │   │   ├── workflow_summary.json  # Workflow statistics
│   │   │   ├── src/              # Source files and task results
│   │   │   │   ├── task_1_researcher.md
│   │   │   │   ├── task_2_analyst.md
│   │   │   │   ├── task_3_writer.md
│   │   │   │   └── ...
│   │   │   └── tests/            # Test files and validation results
│   │   │       └── (test files when applicable)
│   │   │
│   │   └── workflow_id_abc123/   # Or workflow ID if no project name
│   │       ├── workflow_id_abc123_request.json
│   │       ├── FINAL_OUTPUT.md
│   │       ├── workflow_summary.json
│   │       ├── src/
│   │       └── tests/
│   │
│   ├── 2025-10-15/               # Next day's projects
│   │   └── ...
│   └── ...
```

## Naming Conventions

### Project Folder Names
- **Format**: `YYYY-MM-DD/project_name`
- **Space Handling**: All spaces in project names are automatically replaced with underscores
- **Example**: `"paint app"` → `projects/2025-10-14/paint_app/`
- **Fallback**: If no project_name provided, uses workflow_id

### File Naming
- **Request JSON**: `{project_name}_request.json` (spaces replaced with underscores)
- **Final Output**: `FINAL_OUTPUT.md` (consistent across all projects)
- **Workflow Summary**: `workflow_summary.json` (consistent across all projects)
- **Task Results**: `task_{number}_{agent}.md` (e.g., `task_1_researcher.md`)

## Standard Project Structure

Every project folder contains:
1. **Root Files**:
   - `{project_name}_request.json` - Original workflow request with metadata
   - `FINAL_OUTPUT.md` - Synthesized final deliverable
   - `workflow_summary.json` - Workflow statistics and execution data

2. **`src/` Folder**:
   - Individual task execution results
   - Source code or content generated by agents
   - Reasoning-acting history for each task

3. **`tests/` Folder**:
   - Test files (when applicable)
   - Validation results
   - Quality assurance outputs

## Automatic Organization

### When Workflows Complete

When a workflow completes successfully, AgentManager automatically:

1. **Creates Today's Folder**: `projects/YYYY-MM-DD/`
2. **Creates Project Subfolder**: 
   - Uses `project_name` from workflow metadata if provided
   - **Automatically replaces spaces with underscores** for consistent naming
   - Falls back to `workflow_id` if no project name specified
3. **Creates Standard Structure**:
   - `src/` folder for source files and task results
   - `tests/` folder for test files (when applicable)
4. **Saves Original Request**: `{project_name}_request.json` - Captured at workflow submission
5. **Saves Comprehensive Results**:
   - `FINAL_OUTPUT.md` - Synthesized final deliverable
   - `workflow_summary.json` - Workflow statistics and metadata
   - `src/` - Individual task execution details

### File Contents

#### {project_name}_request.json
The original workflow request captured at submission time:
```json
{
  "workflow_id": "workflow_abc123",
  "user_request": "Create a Python calculator application",
  "metadata": {
    "project_name": "calculator",
    "priority": "high"
  },
  "submitted_at": "2025-10-14T12:34:56.789012"
}
```

#### FINAL_OUTPUT.md
The polished, synthesized final deliverable integrating all task results. This is the main output you'll share with end users.

#### workflow_summary.json
```json
{
  "workflow_id": "workflow_abc123",
  "created_at": "2025-10-14T12:34:56.789012",
  "total_tasks": 5,
  "total_execution_time": 45.67,
  "agents_used": ["researcher", "analyst", "writer"],
  "task_count_by_agent": {
    "researcher": 2,
    "analyst": 1,
    "writer": 2
  }
}
```

#### task_results/task_N_agent.md → src/task_N_agent.md
Each task result in the `src/` folder includes:
- Agent type that executed the task
- Execution time
- Complete reasoning-acting history (thoughts, actions, observations)
- Final result from that specific task

## Usage Examples

### Example 1: Creating a Calculator Project

```bash
# Submit a task with project name in metadata
POST /v1/tasks
{
  "user_request": "Create a Python calculator application",
  "metadata": {
    "project_name": "calculator"
  }
}
```

Results saved to:
```
projects/2025-10-14/calculator/
├── calculator_request.json       # Original request captured at submission
├── FINAL_OUTPUT.md
├── workflow_summary.json
├── src/                          # Source files and task results
│   ├── task_1_architect.md
│   ├── task_2_developer.md
│   ├── task_3_developer.md
│   └── task_4_tester.md
└── tests/                        # Test files (when applicable)
```

### Example 2: Project with Spaces in Name

```bash
# Submit a task with spaces in project name
POST /v1/tasks
{
  "user_request": "Create a paint desktop app",
  "metadata": {
    "project_name": "paint app"  # Spaces will be replaced with underscores
  }
}
```

Results saved to:
```
projects/2025-10-14/paint_app/    # Note: spaces → underscores
├── paint_app_request.json
├── FINAL_OUTPUT.md
├── workflow_summary.json
├── src/
└── tests/
```

### Example 3: Automatic Workflow ID Folder

```bash
# Submit without project name
POST /v1/tasks
{
  "user_request": "Write a blog post about AI"
}
}
```

Results saved to:
```
projects/2025-10-14/workflow_xyz789/
├── FINAL_OUTPUT.md
├── workflow_summary.json
└── task_results/
    ├── task_1_researcher.md
    ├── task_2_writer.md
    └── task_3_reviewer.md
```

## Benefits

### 1. **Time-Based Organization**
- Easy to find work from specific dates
- Natural archival structure
- Simple cleanup of old projects

### 2. **Complete Audit Trail**
- Full history of each task's execution
- Performance metrics per workflow
- Agent utilization statistics

### 3. **Easy Sharing**
- `FINAL_OUTPUT.md` ready for immediate delivery
- Supporting task details available for review
- JSON metadata for programmatic processing

### 4. **Multi-Project Support**
- Multiple projects can run on the same day
- Clear separation between different workflows
- Project-specific folder names when provided

## Integration with AgentManager

### Planning Phase
When creating a TaskGraph, you can specify a project name:

```python
await manager.plan_and_save_task(
    user_request="Build a web scraper",
    metadata={
        "project_name": "web_scraper",
        "priority": "high"
    },
    db_service=db_service
)
```

### Synthesis Phase
Results are automatically saved when synthesis completes:

```python
final_output = await manager.synthesize_results(
    workflow_id=workflow_id,
    task_results=results,
    project_name="web_scraper",  # Optional
    save_to_disk=True  # Default
)
```

### Manual Saving
You can also manually save results at any time:

```python
project_folder = manager.save_workflow_results(
    workflow_id=workflow_id,
    results=task_results,
    final_output=final_synthesized_output,
    project_name="my_project"
)
```

## Configuration

### Base Project Directory

Default: `./projects`

You can customize the base directory when initializing AgentManager:

```python
manager = AgentManager(
    base_project_dir="/custom/path/projects"
)
```

### Disabling Auto-Save

If you don't want automatic saving:

```python
final_output = await manager.synthesize_results(
    workflow_id=workflow_id,
    task_results=results,
    save_to_disk=False
)
```

## Best Practices

1. **Use Descriptive Project Names**: Provide meaningful names in metadata for better organization
2. **Regular Cleanup**: Archive or delete old dated folders periodically
3. **Backup Strategy**: Include `projects/` in your backup routines
4. **Version Control**: Add `projects/` to `.gitignore` if outputs are large or sensitive
5. **Documentation**: Keep project-specific READMEs in dated folders for complex workflows

## Volume Mounting for Docker

To persist project folders across container restarts, add to `docker-compose.yml`:

```yaml
services:
  agent-manager:
    volumes:
      - ./projects:/app/projects
      - ./logs:/app/logs
```

This ensures all workflow results are saved on the host machine.

## Future Enhancements

Planned improvements:
- Export workflows as ZIP archives
- Search across project folders
- Web UI for browsing historical results
- Automatic cleanup policies
- Integration with cloud storage (S3, Azure Blob)
